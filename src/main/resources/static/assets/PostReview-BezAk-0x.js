import{g as v,c as S,u as E,a as k,r as n,j as e,T as A,I as x,B,m as D}from"./index-CclgMCKg.js";import{M as U}from"./index-DFlVvL3-.js";import"./jwt-Be9xYbvd.js";import{R as V}from"./api-RMrr9BxD.js";/* empty css                    */import{F as s}from"./index-Y7Vl51Ml.js";import{R as z}from"./index-coMdXwgz.js";import{U as M}from"./index-BfZ_5wYh.js";import{I as $}from"./index-0C1HrTNp.js";import"./motion-BtiDeT7c.js";import"./collapse-BbEVqHco.js";import"./zoom-BWmeO6-E.js";import"./Portal-cEDniDzA.js";import"./useBreakpoint-C1fBIcAO.js";import"./index-BbTjQyva.js";import"./index-CSlYUxik.js";import"./index-Dx4kxOlF.js";import"./useId-C98JHZMn.js";import"./isMobile-DjGTsQxe.js";import"./roundedArrow-S-OOpRVx.js";import"./useLocale-drylJvgs.js";import"./fade-BjX83sUK.js";import"./CheckOutlined-C_iRVmUt.js";import"./index-DF8UPMmw.js";import"./addEventListener-CcJmKnmb.js";import"./RightOutlined-DxWTf1i6.js";const q=o=>new Promise((m,d)=>{const r=new FileReader;r.readAsDataURL(o),r.onload=()=>m(r.result),r.onerror=l=>d(l)}),Ie=()=>{const o=v("user"),m=v("accessToken");console.log("user",o);const[d]=S(),r=d.get("strfId"),l=E(),u=k().state,[b]=s.useForm(),[a,h]=n.useState([]),[J,y]=n.useState(!1),[F,f]=n.useState(!1),[g,I]=n.useState("");n.useEffect(()=>{console.log("fileList",a)},[a]);const N=async t=>{const{content:C,file:c,rating:T,strfId:L,userId:O}=t,j={userId:parseInt(O),strfId:parseInt(L),rating:parseInt(T),content:C},p=new FormData;c!=null&&c.fileList&&h(c.fileList),p.append("p",new Blob([JSON.stringify(j)],{type:"application/json"})),(a==null?void 0:a.length)>0&&a.forEach(i=>{p.append("pics",i.originFileObj)});const w=p.get("p");w&&w.text().then(i=>console.log("p의 내용:",j));try{(await D.post(`${V.postReview}`,p,{headers:{Authorization:`Bearer ${m}`}})).data.code==="200 성공"&&l(-1)}catch(i){console.error(i)}},P=async t=>{!t.url&&!t.preview&&(t.preview=await q(t.originFileObj)),I(t.url||t.preview),f(!0)},R=({fileList:t})=>h(t);return e.jsxs("div",{children:[e.jsx(A,{icon:"back",onClick:()=>{l(-1)},title:u==null?void 0:u.strfTitle}),e.jsx("div",{className:"px-4",children:e.jsxs(s,{form:b,onFinish:N,layout:"vertical",initialValues:{userId:o.userId,strfId:r},children:[e.jsx(s.Item,{label:"userId",name:"userId",hidden:!0,children:e.jsx(x,{value:o.userId})}),e.jsx(s.Item,{label:"strfId",name:"strfId",hidden:!0,children:e.jsx(x,{value:r})}),e.jsx(s.Item,{name:"rating",className:"flex flex-col justify-center items-center  text-slate-300",help:e.jsx("div",{className:" text-base text-center  text-slate-300 mt-[6px] mb-6",children:"별점을 선택해주세요."}),children:e.jsx(z,{style:{fontSize:"2.25rem"}})}),e.jsx("h3",{className:"mb-2 text-slate-700 text-lg text-center font-semibold",children:"리뷰를 남겨주세요."}),e.jsx(s.Item,{name:"content",rules:[{required:!0,message:"리뷰를 입력해주세요."}],children:e.jsx(x.TextArea,{rows:4,showCount:!0,maxLength:500,placeholder:"직접 경험한 솔직한 리뷰를 남겨주세요.",variant:"borderless",onChange:()=>y(!0),className:`custom-text-area rounded-2xl text-slate-700 placeholder: text-base placeholder: text-slate-400
                `})}),e.jsxs(s.Item,{name:"file",children:[e.jsx(M,{id:"file",listType:"picture-card",beforeUpload:()=>!1,accept:"image/*",fileList:a,onPreview:P,onChange:R,multiple:!0,children:e.jsx(U,{className:"text-4xl text-slate-400"})}),g&&e.jsx($,{wrapperStyle:{display:"none"},preview:{visible:F,onVisibleChange:t=>f(t),afterOpenChange:t=>!t&&I("")},src:g})]}),e.jsx(s.Item,{children:e.jsx(B,{type:"primary",htmlType:"submit",className:`w-full h-[80px] py-[10px] rounded-lg\r
              text-[24px] font-semibold`,children:"완료"})})]})})]})};export{Ie as default};
