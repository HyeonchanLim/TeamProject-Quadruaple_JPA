import{j as e,b as le,r as i,bs as ae,aj as Y,u as M,ce as V,cf as re,B as P,d as R,X as ie,ab as oe,W as Q,m as A,aE as ce,Y as ne,c as D,g as de,M as z,a1 as xe,bf as me,ah as pe,ai as _,aR as ue,bU as fe,a0 as he,ad as ee,a6 as se,cg as ge,Z as je,V as be}from"./index-CclgMCKg.js";import{j as S}from"./jwt-Be9xYbvd.js";import{p as te,F,q as ye,c as we,h as Ne,r as ve}from"./match-BrbVKEl2.js";/* empty css                    */import{D as ke}from"./index-C8fV_4ml.js";import{L as Se}from"./index-DK5P-bAW.js";import{D as Ce}from"./DynamicGrid-BXqXMAJw.js";import{R as Ie}from"./index-coMdXwgz.js";import{m as $}from"./proxy-luPhEEJa.js";import{t as E}from"./tripAtom-5AlrFlyN.js";import{a as N,K as Me,b as T,u as $e,M as Te}from"./MarkerClusterer-BX7VY5nJ.js";import{S as Pe,a as Re}from"./swiper-react-BiZMhr8u.js";import{a as Ee}from"./index-DN2QkB1Y.js";/* empty css               *//* empty css                   */import{P as Le}from"./index-_-w7L-mv.js";import{T as Ae}from"./index-Bp8J61U8.js";import"./index-317k7Gzh.js";import"./index-efnQCHqG.js";import"./index-Dyi5F84X.js";import"./customParseFormat--lJaNAof.js";import"./PurePanel-C1JE1xpr.js";import"./index-Dx4kxOlF.js";import"./Portal-cEDniDzA.js";import"./useId-C98JHZMn.js";import"./isMobile-DjGTsQxe.js";import"./Overflow-b40CqTdl.js";import"./useIcons-Bg9STVks.js";import"./CheckOutlined-C_iRVmUt.js";import"./DownOutlined-eQ1uAPVl.js";import"./roundedArrow-S-OOpRVx.js";import"./useLocale-drylJvgs.js";import"./index-0C1HrTNp.js";import"./index-DF8UPMmw.js";import"./index-BbTjQyva.js";import"./fade-BjX83sUK.js";import"./zoom-BWmeO6-E.js";import"./addEventListener-CcJmKnmb.js";import"./motion-BtiDeT7c.js";import"./RightOutlined-DxWTf1i6.js";import"./index-CSlYUxik.js";import"./EllipsisOutlined-BwAZKzUe.js";const Ye=({handleCancel:l,amenities:s})=>(console.log(s),e.jsxs("div",{className:"fixed top-0 left-1/2  -translate-x-1/2 z-[999] bg-white w-full max-w-[768px] h-screen",children:[e.jsx("div",{className:"",children:e.jsx(le,{icon:"close",title:"편의시설 및 서비스",onClick:l})}),e.jsx("ul",{className:"flex flex-wrap mt-6 px-4 gap-5",children:s.map(r=>e.jsxs("li",{className:"min-w-14 flex flex-col items-center justify-center gap-[6px] text-slate-700",children:[e.jsx("i",{className:"text-2xl ",children:te(r.amenityId??0)}),e.jsx("p",{children:r.amenityTitle})]},r.amenityId))})]})),ze=({strfId:l})=>{const[s,r]=i.useState(),[a,n]=i.useState(!1),d=async()=>{try{const t=await S.get(`/api/detail/amenity?strf_id=${l}&category=숙소`);r(t.data.data),console.log("편의시설 조회",t.data.data)}catch(t){console.log("편의시설 조회",t)}};return i.useEffect(()=>{d()},[]),e.jsxs("div",{className:"px-4 my-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-slate-700 text-xl",children:"편의시설 및 서비스"}),e.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-[6px] text-sm text-slate-400",children:["더보기 ",e.jsx(ae,{className:"text-xl"})]})]}),e.jsx("ul",{className:"grid grid-flow-col gap-4 overflow-hidden w-full h-[90px] mt-3",children:s==null?void 0:s.map(t=>e.jsxs("li",{className:"min-w-14 flex flex-col items-center justify-center gap-[6px] text-slate-700",children:[e.jsx("i",{className:"text-2xl ",children:te(t.amenityId??0)}),e.jsx("p",{children:t.amenityTitle})]},t.amenityId))}),a?e.jsx(Ye,{handleCancel:()=>n(!a),amenities:s}):null]})},_e=({strfId:l,menuData:s})=>e.jsxs("div",{className:"px-4 my-6",children:[e.jsx("h3",{className:"font-semibold text-slate-700 text-xl",children:"대표메뉴"}),e.jsx("ul",{className:"grid grid-cols-2 gap-3 mt-5",children:s.map(r=>e.jsxs("li",{children:[e.jsx("div",{className:"w-full aspect-square rounded-2xl overflow-hidden",children:e.jsx("img",{src:`${Y}/${l}/menu/${r==null?void 0:r.menuPic}`,alt:r==null?void 0:r.menuTitle,className:"w-full h-full object-cover "})}),e.jsxs("div",{className:"mt-2 text-slate-700",children:[e.jsx("p",{className:"text-lg",children:r.menuTitle}),e.jsxs("p",{className:"text-base font-semibold tracking-tight",children:[r.menuPrice.toLocaleString(),"원"]})]})]},r.menuId))})]}),Fe=({strfId:l,menuData:s})=>e.jsxs("div",{className:"px-4 my-6",children:[e.jsx("h3",{className:"font-semibold text-slate-700 text-xl",children:"입장권"}),e.jsx("ul",{children:s.map(r=>e.jsxs("li",{className:"flex items-center justify-between gap-4 py-4 border-b border-slate-200 last:border-b-0",children:[e.jsxs("div",{className:"text-slate-700",children:[e.jsx("h3",{className:"text-lg",children:r.menuTitle}),e.jsxs("p",{className:"text-base font-semibold",children:[r.menuPrice.toLocaleString(),"원"]})]}),e.jsx("div",{className:"w-24 aspect-square overflow-hidden rounded-2xl",children:e.jsx("img",{src:`${Y}/${l}/menu/${r==null?void 0:r.menuPic}`,alt:r==null?void 0:r.menuTitle,className:"w-full h-full object-cover "})})]},r.menuId))})]}),{RangePicker:qe}=ke,Be=({strfId:l,menuData:s,contentData:r})=>{const a=M(),[n,d]=i.useState([]),[t,x]=i.useState([]),[g,p]=i.useState(null),[o]=i.useState(1),[,y]=i.useState({}),v=async(m,c)=>{try{const j=await S.get(`/api/detail/check?strfId=${l}&checkIn=${m}&checkOut=${c}`);j.data&&(console.log("예약 조회 응답:",j.data),d(j.data),y({}))}catch(j){console.log("예약 조회 에러:",j),d([])}};i.useEffect(()=>{console.log("inquiry 상태 변경됨:",n),y({})},[n]);const b=async()=>{var m;try{const c=await S.get(`/api/detail/parlor?strf_id=${l}&category=숙소`);(m=c.data)!=null&&m.data&&x(c.data.data),console.log("예약 가능 여부:",c.data)}catch(c){console.log("예약 조회 에러:",c),d([])}};i.useEffect(()=>{b()},[]);const w=m=>{if(m){const[c,j]=m,u=R(c).format("YYYY-MM-DD"),h=R(j).format("YYYY-MM-DD");p([u,h]),v(u,h)}else p(null),d([])},k=m=>{if(!g){ie.warning("날짜를 선택해주세요");return}a(`/booking/index?strfId=${l}`,{state:{quantity:o,dates:g,item:m,contentData:r,isRoom:t}})};console.log("isRoom",t);const I=m=>!!m&&m.isBefore(R().startOf("day"));return e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"px-4",children:e.jsx(qe,{className:"custom-lodgment-picker w-full border-slate-300 rounded-lg py-3 text-slate-700 mb-3",onChange:w,disabledDate:I,format:"YYYY-MM-DD"})}),e.jsx("ul",{children:s==null?void 0:s.map((m,c)=>{var j,u;return e.jsxs("li",{className:"py-5 px-4 border-b-[10px] border-slate-100 last:border-b-0",children:[e.jsx("i",{children:e.jsx("img",{src:`${Y}/${l}/menu/${m==null?void 0:m.menuPic}`,alt:m==null?void 0:m.menuTitle,className:"w-full aspect-[2/1] object-cover rounded-lg"})}),e.jsxs("div",{className:"my-3",children:[e.jsx("h2",{className:"text-2xl text-slate-700 font-semibold",children:m==null?void 0:m.menuTitle}),e.jsxs("p",{className:"flex items-center gap-[6px] text-slate-500 text-sm my-1",children:[e.jsx(V,{className:"text-base"}),"입실 ",m.openCheckIn.replace(/:\d{2}$/,"")," - 퇴실",m.closeCheckIn.replace(/:\d{2}$/,"")]}),e.jsxs("p",{className:"flex items-center gap-[6px] text-slate-500 text-sm",children:[e.jsx(re,{className:"text-base"}),"기준 ",m.recomCapacity,"인 / 최대 ",m.maxCapacity,"인"]}),e.jsxs("div",{className:"w-full border-t border-slate-100 mt-3 pt-3 flex justify-between items-center",children:[e.jsxs("span",{className:"text-xl text-slate-700 font-semibold",children:[m.menuPrice.toLocaleString(),"원"]}),e.jsx(P,{type:"primary",className:"text-base py-2 px-4 h-auto rounded-lg",onClick:()=>k(m),disabled:!((j=n[c])!=null&&j.check),children:(u=n[c])!=null&&u.check?"예약하기":"예약불가"})]})]})]},m.menuId)})})]})},Oe=({strfId:l,contentData:s})=>{console.log("contentData",s);const r=M(),[a,n]=i.useState([]),[d,t]=i.useState(),[x,g]=i.useState(0),[p,o]=i.useState(null),[y,v]=i.useState({}),b=i.useRef({}),[w,k]=i.useState(0);console.log(d),console.log("리뷰 목록:",a),console.log("reviewIndex:",x);const I=i.useCallback(async()=>{console.log("지금 보내는 start_idx",x);try{const c=await S.get(`/api/review?strf_id=${l}&start_idx=${x}`);console.log("리뷰 불러오기:",c.data),n([...a,...c.data.dtoList]),t(c.data.more)}catch(c){console.log("리뷰 불러오기:",c)}},[x,a,l]),m=async()=>{try{const c=await A.get(`/api/detail/count?strf_id=${l}`);k(c.data.data),console.log("리뷰 수:",c)}catch(c){console.error("리뷰 수 불러오기 실패:",c)}};return i.useEffect(()=>{I()},[x]),i.useEffect(()=>{m()},[l]),i.useEffect(()=>{const c={};a.forEach((j,u)=>{const h=b.current[u];if(h){const C=parseInt(window.getComputedStyle(h).lineHeight),f=h.scrollHeight;c[u]=f>C*3}}),v(c)},[a]),e.jsxs("div",{children:[e.jsxs("p",{className:"text-base text-slate-700 px-4",children:[e.jsx("span",{className:"font-semibold text-primary",children:w}),"개의 리뷰"]}),a?e.jsx("ul",{children:a==null?void 0:a.map((c,j)=>{const u=y[j];return e.jsxs("li",{className:"flex flex-col gap-3 py-8 border-b border-slate-200 px-4 last:border-none",children:[e.jsxs("div",{className:"flex flex-col gap-[6px]",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden",children:e.jsx("img",{src:`${oe}/${c.writerUserId}/${c.writerUserPic}`,alt:"pofilePic",className:"w-full h-full object-cover"})}),e.jsx("p",{className:"font-semibold text-slate-700 text-base",children:c.writerUserName})]}),e.jsxs("div",{className:"flex gap-[6px] items-center",children:[e.jsx(Se,{className:"text-base text-slate-300"}),e.jsx("p",{className:"font-semibold text-sm text-slate-500",children:c.userWriteReviewCnt})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex gap-[6px]",children:[e.jsx(Ie,{disabled:!0,count:5,value:c.rating,className:"custom-review-rate"}),e.jsx("p",{className:"font-semibold text-sm text-slate-700",children:c.rating}),e.jsxs("button",{type:"button",className:"text-slate-400 flex gap-1 items-center justify-center text-sm",onClick:()=>{r(`/report?type=${Q.STRF}&reportTarget=${s==null?void 0:s.strfId}`)},children:[e.jsx("span",{children:"|"}),e.jsx("span",{children:"신고"})]})]}),e.jsx("div",{children:e.jsx("p",{className:"text-sm text-slate-500",children:c.reviewWriteDate.split(" ")[0].replace(/-/g,".")})})]})]}),e.jsxs("div",{children:[e.jsx("p",{ref:h=>b.current[j]=h,className:`text-sm tracking-tight ${p===j?"":"line-clamp-3"}`,children:c.content}),u&&p!==j&&e.jsx("button",{type:"button",className:"text-primary text-sm font-semibold mt-[6px]",onClick:()=>o(j),children:"더보기"})]}),c.reviewPic&&c.reviewPic.length>0&&e.jsx(Ce,{reviewPics:c,type:"review"})]},j)})}):e.jsx("ul",{children:e.jsx("li",{className:"flex flex-col gap-[20px] py-[30px] border-b border-slate-200"})}),d===!0&&e.jsx("button",{type:"button",className:"w-full py-[20px] rounded-lg border border-slate-300",onClick:()=>g(c=>c+10),children:"리뷰 더보기"})]})},He=i.memo(Oe),Ue=({open:l,onClose:s})=>{const[r,a]=i.useState([]),n=M();console.log(l);const d=async()=>{try{const t=await S.get("/api/trip-list");a(t.data.data.beforeTripList)}catch(t){console.log("여행 목록 불러오기:",t)}};return i.useEffect(()=>{d()},[]),e.jsx("div",{children:e.jsx($.div,{tabIndex:-1,className:"max-w-[768px] w-full left-1/2 -translate-x-1/2 fixed inset-0 bg-black/50 flex justify-center items-end z-50 overflow-hidden",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(),children:e.jsxs($.div,{className:" bg-white w-full rounded-t-3xl py-5 shadow-lg",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",stiffness:300,damping:30},drag:"y",dragConstraints:{top:0,bottom:100},dragElastic:.2,onDragEnd:(t,x)=>{x.offset.y>100&&s()},onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"w-12 h-1 bg-slate-400 rounded-full mx-auto mb-4"}),e.jsxs("div",{onClick:()=>n("/search/location"),className:"w-auto h-auto p-5 bg-slate-50 rounded-lg flex items-center gap-5 mx-3 cursor-pointer mb-4",children:[e.jsx("i",{className:"inline-block p-[10px] bg-primary rounded-full",children:e.jsx(ce,{className:"text-white"})}),e.jsx("div",{children:e.jsx("p",{className:"text-lg text-slate-700 font-semibold",children:"여행 일정 만들기"})})]}),e.jsx("div",{className:"px-3",children:r.map(t=>e.jsxs("div",{className:"flex items-center gap-3 w-full bg-slate-50 p-5 rounded-lg mb-3 cursor-pointer",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("img",{src:`${ne}/${t.locationPic}`,alt:t.title,className:"w-full h-full"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h3",{className:"text-base text-slate-700 font-semibold",children:t.title}),e.jsxs("p",{className:"text-sm text-slate-500 tracking-tight",children:[t.startAt.replace(/-/g,".")," -"," ",t.endAt.replace(/-/g,".")]})]})]}))})]})})})},Ke=({open:l,onClose:s})=>{console.log(l);const r=M(),[a]=D(),n=a.get("strfId"),d=de("accessToken"),[t]=z(E),x=xe(E);console.log("trip",t);const[g,p]=i.useState([]),[o,y]=i.useState(""),[v,b]=i.useState(null),[w,k]=i.useState(),I=async()=>{try{const h=(await A.get(`/api/transport/get?startLngSX=${t.prevSchelng}&startLatSY=${t.prevSchelat}&endLngEX=${t.nowLng}&endLatEY=${t.nowLat}`,{headers:{Authorization:`Bearer ${d}`}})).data;return p(h.data),y(h.code),t.lastSeq===0&&m(),h}catch(u){return console.log("길찾기 결과",u),null}},m=async()=>{const u="/api/schedule",h={seq:t.lastSeq+1,day:t.day,time:t.lastSeq!==0&&o==="200 성공"?w==null?void 0:w.totalTime:null,distance:t.lastSeq!==0&&o==="200 성공"?w==null?void 0:w.totalDistance:null,strf_id:n,trip_id:t.nowTripId,path_type:t.lastSeq!==0&&o==="200 성공"?w==null?void 0:w.pathType:null};try{(await A.post(u,h,{headers:{Authorization:`Bearer ${d}`}})).data&&(x(),r(`/schedule/index?tripId=${t.nowTripId}`))}catch(C){console.log("일정 등록",C)}},c=u=>{const h=Math.floor(u/60),C=u%60;return`${h}시간 ${C.toString().padStart(2,"0")}분`},j=()=>{m()};return i.useEffect(()=>{I()},[]),e.jsx($.div,{tabIndex:-1,className:"max-w-[768px] w-full left-1/2 -translate-x-1/2 fixed inset-0 bg-black/50 flex justify-center items-end z-[9999] overflow-hidden",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(),children:e.jsx($.div,{className:" bg-white w-full rounded-t-3xl py-5 shadow-lg",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",stiffness:300,damping:30},drag:"y",dragConstraints:{top:0,bottom:100},dragElastic:.2,onDragEnd:(u,h)=>{h.offset.y>100&&s()},onClick:u=>u.stopPropagation(),children:e.jsxs("div",{className:"px-8",children:[e.jsx("h2",{className:"text-2xl text-slate-700 font-bold px-1 pt-8 pb-6",children:"빠른 길 찾기"}),e.jsx("section",{children:e.jsxs("ul",{className:`flex flex-col w-full \r
                      px-6 py-3 gap-3\r
                      border border-slate-300 rounded-2xl`,children:[e.jsxs("li",{className:"flex gap-3 items-center py-3",children:[e.jsx(me,{className:"text-slate-300 text-xl"}),e.jsx("span",{className:"text-slate-700",children:t==null?void 0:t.nowName})]}),e.jsx("li",{className:"w-full h-[1px] bg-slate-100"}),e.jsxs("li",{className:"flex gap-3 items-center py-3",children:[e.jsx(F,{className:"text-primary text-xl"}),e.jsx("span",{className:"text-slate-700",children:t.prevScheName})]})]})}),e.jsxs("section",{children:[o==="400 거리가 너무 가깝거나 잘못된 값입니다."&&e.jsx("div",{className:`flex gap-5 items-center 
                          py-3
                          text-slate-700
                            rounded-lg`,children:o}),o==="200 성공"&&e.jsx("ul",{className:`flex flex-col  py-5 gap-7\r
              max-h-[30vh] overflow-y-auto`,children:g==null?void 0:g.map((u,h)=>e.jsxs("li",{className:`flex gap-5 items-center 
                          px-5 py-3
                          hover:bg-slate-50 cursor-pointer
                            rounded-lg
                            ${h===v?"bg-slate-100":"bg-white"}
                            `,onClick:()=>{b(h),console.log(u),k(u)},children:[e.jsx("div",{className:"text-2xl text-slate-400",children:ye(u.pathType)}),e.jsxs("ul",{className:"flex gap-3 items-center",children:[e.jsx("li",{className:"text-slate-700 text-2xl font-semibold",children:u.totalTime>60?c(u.totalTime):`${u.totalTime}분`}),e.jsxs("li",{className:"text-slate-700 text-base font-semibold",children:[u.payment.toLocaleString(),"원"]}),e.jsx("li",{className:"font-medium text-sm text-slate-400",children:u.totalDistance>1e3?`${(u.totalDistance/1e3).toFixed(2)}km`:`${u.totalDistance}m`})]})]},h))}),e.jsx("div",{className:"pb-5",children:e.jsx(P,{type:"primary",htmlType:"button",className:"text-2xl py-5 max-h-[50px] h-[16vw] w-full text-white font-semibold",onClick:j,children:"선택 완료"})})]})]})})})},Xe=({strfId:l,contentData:s})=>{const[,r]=i.useState({isRegistModalOpen:!1,openPathModal:!1,isReviewModalOpen:!1}),[a]=z(E),[n,d]=i.useState(!1),[t,x]=i.useState(!1),g=M(),p=()=>{r(o=>({...o,isReviewModalOpen:!0})),g(`/contents/postreview?strfId=${l}`,{state:s})};return e.jsxs("div",{className:"sticky bottom-0 left-0 z-50 w-full px-4 py-5 flex gap-3 bg-white border-t-[1px] border-slate-100",children:[e.jsx(P,{onClick:()=>{d(!n),x(!t)},icon:e.jsx(F,{className:"!text-sm opacity-50 mb-[2px]"}),className:"flex items-center justify-center gap-[6px] border-slate-200 rounded-lg w-full h-auto py-[14px] text-lg text-slate-700 ",children:"일정 추가"}),e.jsx(P,{onClick:()=>{p()},icon:e.jsx(pe,{className:"text-sm opacity-50 mb-[2px]"}),className:"flex items-center justify-center gap-[6px]  border-slate-200 rounded-lg w-full  h-auto py-[14px] text-lg text-slate-700 ",children:"리뷰쓰기"}),n&&a.nowTripId===0&&e.jsx(Ue,{open:n,onClose:()=>d(!1)}),a.nowTripId!==0&&t&&e.jsx(Ke,{open:t,onClose:()=>x(!1)})]})},Ze=_.forwardRef(function(s,r){let{map:a,position:n,marker:d,children:t,altitude:x,disableAutoPan:g,range:p,removable:o,zIndex:y,onCreate:v}=s;const b=i.useMemo(()=>{const k=document.createElement("div");return k.style.display="none",new kakao.maps.InfoWindow({altitude:x,disableAutoPan:g,range:p,removable:o,zIndex:y,content:k,position:n})},[g,o]),w=i.useMemo(()=>b.getContent(),[b]);return i.useImperativeHandle(r,()=>b,[b]),i.useLayoutEffect(()=>(b.open(a,d),()=>{b.close()}),[a,d]),i.useLayoutEffect(()=>{v&&v(b)},[b,v]),N(b,"setPosition",n),N(b,"setAltitude",x),N(b,"setRange",p),N(b,"setZIndex",y),ue.createPortal(t,w.parentElement??w)}),We=_.forwardRef(function(s,r){let{map:a,position:n,children:d,altitude:t,clickable:x,draggable:g,image:p,infoWindowOptions:o,onCreate:y,onClick:v,onDragEnd:b,onDragStart:w,onMouseOut:k,onMouseOver:I,opacity:m,range:c,title:j,zIndex:u}=s;const h=i.useContext(Me),C=i.useMemo(()=>{var L,q,B,O,H,U,K,X,Z,W,G,J;return p&&new kakao.maps.MarkerImage(p.src,new kakao.maps.Size(p.size.width,p.size.height),{alt:(L=p.options)==null?void 0:L.alt,coords:(q=p.options)==null?void 0:q.coords,offset:((B=p.options)==null?void 0:B.offset)&&new kakao.maps.Point((O=p.options)==null?void 0:O.offset.x,(H=p.options)==null?void 0:H.offset.y),shape:(U=p.options)==null?void 0:U.shape,spriteOrigin:((K=p.options)==null?void 0:K.spriteOrigin)&&new kakao.maps.Point((X=p.options)==null?void 0:X.spriteOrigin.x,(Z=p.options)==null?void 0:Z.spriteOrigin.y),spriteSize:((W=p.options)==null?void 0:W.spriteSize)&&new kakao.maps.Size((G=p.options)==null?void 0:G.spriteSize.width,(J=p.options)==null?void 0:J.spriteSize.height)})},[JSON.stringify(p)]),f=i.useMemo(()=>new kakao.maps.Marker({altitude:t,clickable:x,draggable:g,image:C,opacity:m,range:c,title:j,zIndex:u,position:n}),[]);return i.useImperativeHandle(r,()=>f,[f]),i.useLayoutEffect(()=>h?(h.addMarker(f,!0),()=>h.removeMarker(f,!0)):(f.setMap(a),()=>f.setMap(null)),[a,h,f]),i.useLayoutEffect(()=>{y&&y(f)},[f,y]),N(f,"setPosition",n),N(f,"setImage",C),N(f,"setAltitude",t),N(f,"setClickable",x),N(f,"setDraggable",g),N(f,"setOpacity",m),N(f,"setRange",c),N(f,"setRange",c),N(f,"setTitle",j),N(f,"setTitle",j),N(f,"setZIndex",u),T(f,"click",v),T(f,"dragstart",w),T(f,"dragend",b),T(f,"mouseout",k),T(f,"mouseover",I),d?e.jsx(Ze,{position:n,map:a,marker:f,altitude:o==null?void 0:o.altitude,disableAutoPan:o==null?void 0:o.disableAutoPan,range:o==null?void 0:o.range,removable:o==null?void 0:o.removable,zIndex:o==null?void 0:o.zIndex,children:d}):null}),Ge=_.forwardRef(function(s,r){let{position:a,...n}=s;const d=$e("MapMarker"),t=i.useMemo(()=>"lat"in a?new kakao.maps.LatLng(a.lat,a.lng):new kakao.maps.Coords(a.x,a.y).toLatLng(),[a.lat,a.lng,a.x,a.y]);return e.jsx(We,{map:d,position:t,...n,ref:r})}),Je=({contentData:l})=>{const[s,r]=i.useState(!1),[a,n]=i.useState({lat:0,lng:0}),d={lat:(l==null?void 0:l.latit)||35.868358,lng:(l==null?void 0:l.longitude)||128.593778};return i.useEffect(()=>{const t=document.createElement("script");return t.async=!0,t.src="//dapi.kakao.com/v2/maps/sdk.js?appkey=1227efa5c91b2ace09ab915e643a15c9&autoload=false",t.addEventListener("load",()=>{window.kakao.maps.load(()=>{r(!0)})}),document.head.appendChild(t),()=>{document.head.removeChild(t)}},[]),s?e.jsx("div",{children:e.jsx(Te,{center:d,style:{width:"100%",aspectRatio:"4 / 2",minHeight:"200px",borderRadius:"8px"},level:5,children:e.jsx(Ge,{position:d})})}):e.jsx("div",{children:"지도를 불러오는 중입니다..."})},Ve=i.memo(Je),Qe=({contentData:l})=>{const s=M(),[r,a]=i.useState(!1),[n,d]=i.useState(!1),t=i.useRef(null);return i.useEffect(()=>{t.current&&d(t.current.scrollHeight>t.current.clientHeight)},[l==null?void 0:l.detail]),e.jsxs("div",{children:[e.jsxs("section",{className:"my-6 px-4",children:[e.jsx("h3",{className:"font-semibold text-slate-700 text-xl mb-4",children:"소개"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("p",{ref:t,className:`text-base text-slate-500 ${r?"":"line-clamp-5"}`,children:l==null?void 0:l.detail}),n&&!r&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-white/100 to-white/0"})]}),n&&e.jsx(P,{onClick:()=>a(x=>!x),className:"w-full h-auto py-[14px] border border-slate-300 rounded-lg",children:r?"숨기기":"펼치기"})]}),e.jsx("section",{className:"w-full h-[10px] bg-slate-100"}),e.jsxs("section",{className:"my-6 px-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-slate-700 text-xl mb-4",children:"위치"}),e.jsxs("button",{type:"button",className:"text-slate-400 flex gap-1 items-center text-sm font-semibold",onClick:()=>{s(`/report?type=${Q.STRF}&reportTarget=${l==null?void 0:l.strfId}`)},children:[e.jsx(fe,{}),"문제 보고"]})]}),e.jsx(Ve,{contentData:l}),e.jsx("div",{children:e.jsxs("dl",{className:"mt-4 px-4 py-6 bg-slate-50 rounded-lg",children:[e.jsx("dt",{className:"text-base text-slate-700 font-semibold float-left mr-3",children:"주소"}),e.jsxs("dd",{className:"text-base text-slate-500 mb-1",children:["(",l==null?void 0:l.post,") ",l==null?void 0:l.address]}),e.jsx("dt",{className:"text-base text-slate-700 font-semibold float-left mr-3",children:"전화"}),e.jsx("dd",{className:"text-base text-slate-500 mb-1",children:"062-610-7000"}),e.jsx("dt",{className:"text-base text-slate-700 font-semibold float-left mr-3",children:"사업자번호"}),e.jsx("dd",{className:"text-base text-slate-500",children:"410-86-60209"})]})})]})]})},De=({coupon:l,setIsOpen:s})=>{const r=async a=>{try{const n=await S.put(`/api/detail/receive?coupon_id=${a.couponId}`);console.log("쿠폰 적용 성공:",n.data)}catch(n){console.error("쿠폰 적용 실패:",n)}};return e.jsx("div",{children:e.jsx($.div,{tabIndex:-1,className:"max-w-[768px] w-full left-1/2 -translate-x-1/2 fixed inset-0 bg-black/50 flex justify-center items-end z-[9999] overflow-hidden",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>s(!1),children:e.jsxs($.div,{className:" bg-white w-full rounded-t-3xl py-5 shadow-lg px-4",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",stiffness:300,damping:30},drag:"y",dragConstraints:{top:0,bottom:100},dragElastic:.2,onDragEnd:(a,n)=>{n.offset.y>100&&s(!1)},onClick:a=>a.stopPropagation(),children:[e.jsx("div",{className:"w-12 h-1 bg-slate-400 rounded-full mx-auto mb-4"}),e.jsx("h2",{className:"text-xl text-slate-700 font-semibold mb-6",children:"쿠폰 선택"}),e.jsx("ul",{className:"max-h-[411px] overflow-y-scroll flex flex-col gap-3",children:l.map(a=>e.jsxs("li",{className:"flex flex-col gap-1 py-5 px-4 border border-slate-200 rounded-lg",onClick:()=>r(a),children:[e.jsxs("p",{className:"text-xl text-primary font-semibold",children:[a.discountPer,"%"]}),e.jsx("h4",{className:"text-lg text-slate-700 font-semibold",children:a.couponName}),e.jsx("p",{className:"text-sm text-slate-400 font-light",children:`${R(a.expiredAt).format("YYYY.MM.DD")} 사용 가능`})]},a.couponId))})]})})})},es=({strfId:l,contentData:s})=>{const[r,a]=i.useState([]),[n,d]=i.useState(!1),t=async()=>{try{const x=await S.get(`/api/detail/coupon?strf_id=${l}`);a(x.data),console.log("응답 전체:",x),console.log("쿠폰",x.data)}catch(x){console.log("error",x)}};return i.useEffect(()=>{t()},[]),e.jsxs("div",{children:[e.jsx("div",{children:e.jsx(Pe,{loop:!0,className:"mySwiper flex",children:s==null?void 0:s.strfPics.map((x,g)=>e.jsx(Re,{className:"aspect-[1/2] max-h-[500px]",children:e.jsx("img",{src:`${he}/${l}/${x==null?void 0:x.strfPics}`,alt:(s==null?void 0:s.strfTitle)||"",className:"w-full h-full object-cover"})},g))})}),e.jsxs("div",{className:"px-4 py-3 flex flex-col gap-2",children:[e.jsx("p",{className:"text-sm text-slate-500 -mb-[6px]",children:we(s==null?void 0:s.category)}),e.jsx("h2",{className:"text-2xl text-slate-700 font-semibold",children:s==null?void 0:s.strfTitle}),e.jsxs("p",{className:"text-sm text-slate-500 flex items-center gap-[6px]",children:[e.jsx(F,{className:" text-slate-300"}),s==null?void 0:s.address]}),e.jsxs("ul",{className:"flex items-center gap-[6px]",children:[e.jsx("li",{children:e.jsx(Ee,{className:"text-primary text-base"})}),e.jsx("li",{className:"text-sm text-slate-700 font-semibold",children:s==null?void 0:s.ratingAvg}),e.jsxs("li",{className:"text-sm text-primary underline",children:["리뷰 ",s==null?void 0:s.reviewCnt.toLocaleString(),"개"]}),e.jsx("li",{className:"text-slate-300 text-base mx-1",children:"|"}),e.jsx("li",{className:"text-lg text-slate-400",children:s!=null&&s.wishIn?e.jsx(ee,{className:"text-secondary3"}):e.jsx(se,{})}),e.jsx("li",{className:"text-slate-500 text-sm",children:s==null?void 0:s.wishCnt})]}),e.jsx("div",{children:e.jsxs("p",{className:"flex items-center gap-[6px] text-slate-500",children:[e.jsx(V,{className:"text-sm"}),s!=null&&s.restDate&&s.restDate.length>0?s.restDate.map(x=>` ${Ne(x)}요일 휴무 `):"매일",s==null?void 0:s.openCheck.replace(/:\d{2}$/,"")," ~",s==null?void 0:s.closeCheck.replace(/:\d{2}$/,"")]})}),(s==null?void 0:s.category)==="STAY"&&e.jsx("div",{className:"w-full flex flex-col gap-[30px]",children:e.jsxs("button",{type:"button",onClick:()=>d(!n),className:"w-full gap-3 flex items-center justify-between  rounded-lg px-4 py-3 border border-primary2 text-primary text-[16px] font-semibold",children:["쿠폰 받기",e.jsx(ge,{className:"text-xl"})]})})]}),n&&e.jsx(De,{coupon:r,setIsOpen:d})]})},ss=({scrollEvent:l=!0,strfId:s,contentData:r,getDetailMember:a})=>{const[n,d]=i.useState(!1),t=M(),x=async()=>{const o={strfId:s};console.log("찜하기 데이터:",o);try{const y=await S.post("/api/wish-list",{...o});console.log("찜하기",y.data),y.data.code==="200 성공"&&a()}catch(y){console.log("찜하기",y)}};i.useEffect(()=>{if(!l){d(!1);return}const o=()=>{window.scrollY>0?d(!0):d(!1)};return window.addEventListener("scroll",o),()=>{window.removeEventListener("scroll",o)}},[l]);const g=window.location.href,p=async()=>{try{await navigator.clipboard.writeText(g)}catch(o){console.error("복사 실패",o)}};return console.log("currentUri",g),e.jsx("div",{className:`max-w-[768px] w-full px-4  fixed top-0 left-1/2 -translate-x-1/2 z-10
        duration-300 ${l?n?"bg-white text-slate-700":"bg-transparent text-white":"bg-transparent"}`,children:e.jsxs("div",{className:"flex justify-between items-center h-[60px]",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(je,{className:"text-3xl min-w-7 cursor-pointer",onClick:()=>t(-1)}),e.jsx("h2",{className:"font-semibold text-lg line-clamp-1",children:r==null?void 0:r.strfTitle})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[r!=null&&r.wishIn?e.jsx(ee,{className:`text-2xl cursor-pointer ${scrollY>0?"text-secondary3":"text-white"}`,onClick:x}):e.jsx(se,{className:`text-2xl cursor-pointer ${scrollY>0?"text-slate-700":"text-white"}`,onClick:x}),e.jsx(Le,{className:"!rounded-2xl",content:e.jsxs("div",{className:"flex items-center justify-between gap-3 bg-slate-100 pl-3 pr-1 py-1 rounded-lg",children:[e.jsx("p",{className:"line-clamp-1 w-[189px]",children:g}),e.jsxs("button",{onClick:()=>p(),className:" flex items-center gap-1 bg-primary px-3 py-1 rounded-lg text-white",children:[e.jsx(ve,{}),"복사"]})]}),trigger:"click",getPopupContainer:o=>o.parentElement||document.body,children:e.jsx(be,{className:" text-2xl cursor-pointer"})})]})]})})},Us=()=>{const[,l]=z(E),[s,r]=i.useState(null),[a,n]=i.useState([]),[d]=D(),t=Number(d.get("strfId"))||0,x=d.get("tab")||"1",g=async()=>{try{const o=await S.get(`/api/detail/member?&strf_id=${t}`);o.data.data,console.log("상품조회-회원",o.data.data),r(o.data.data),l(y=>({...y,nowName:o.data.data.strfTitle,nowLat:o.data.data.latit,nowLng:o.data.data.longitude}))}catch(o){console.log("상품조회-회원",o)}},p=async()=>{try{const o=await S.get(`/api/detail/menu?strf_id=${t}`);n(o.data.data),console.log("상품조회-메뉴",o.data.data)}catch(o){console.log("상품조회-메뉴",o)}};return i.useEffect(()=>{p(),g()},[]),e.jsxs("div",{children:[s&&e.jsx(ss,{strfId:t,contentData:s,getDetailMember:g}),e.jsx("section",{children:s&&e.jsx(es,{strfId:t,contentData:s})}),a&&e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"w-full h-[10px] bg-slate-100"}),e.jsxs("section",{children:[(s==null?void 0:s.category)==="STAY"&&e.jsx(Be,{strfId:t,menuData:a,contentData:s,getMenuDetail:p}),(s==null?void 0:s.category)==="RESTAUR"&&e.jsx(_e,{strfId:t,menuData:a}),((s==null?void 0:s.category)==="TOUR"||(s==null?void 0:s.category)==="FEST")&&e.jsx(Fe,{strfId:t,menuData:a})]}),e.jsx("section",{className:"w-full h-[10px] bg-slate-100"})]}),(s==null?void 0:s.category)==="STAY"&&e.jsxs(e.Fragment,{children:[e.jsx("section",{children:e.jsx(ze,{strfId:t})}),e.jsx("section",{className:"w-full h-[10px] bg-slate-100"})]}),e.jsx("section",{children:e.jsx(Ae,{defaultActiveKey:x,centered:!0,className:"custom-strf-tabs",items:[{label:"상세정보",key:"1",children:e.jsx(e.Fragment,{children:s&&e.jsx(Qe,{strfId:t,contentData:s})})},{label:"리뷰",key:"2",children:e.jsx(e.Fragment,{children:s&&e.jsx(He,{strfId:t,contentData:s})})}]})}),s&&e.jsx(Xe,{strfId:t,contentData:s})]})};export{Us as default};
