import{G as U,c as L,u as S,M as R,aC as v,r as y,m as k,j as e,T as J,B as $,a0 as K,ad as Y,a6 as q,a1 as F,J as B,bv as Q,g as W,Z as X,I as ee,$ as te}from"./index-CclgMCKg.js";import"./swiper-react-BiZMhr8u.js";import{o as _,c as I}from"./search-CYEcxJpF.js";import{e as ae,c as se}from"./match-BrbVKEl2.js";import{f as re}from"./index-317k7Gzh.js";import{F as le}from"./index-Y7Vl51Ml.js";import{N as E}from"./NoData-CVZyKg5f.js";import{R as ce}from"./index-coMdXwgz.js";import{S as oe}from"./index-CwwfHYk5.js";import{S as ne}from"./index-DzJzb7gE.js";import"./index-efnQCHqG.js";import"./index-DK5P-bAW.js";import"./index-Dyi5F84X.js";import"./motion-BtiDeT7c.js";import"./collapse-BbEVqHco.js";import"./zoom-BWmeO6-E.js";import"./Portal-cEDniDzA.js";import"./useBreakpoint-C1fBIcAO.js";import"./index-BbTjQyva.js";import"./index-CSlYUxik.js";import"./index-Dx4kxOlF.js";import"./useId-C98JHZMn.js";import"./isMobile-DjGTsQxe.js";import"./roundedArrow-S-OOpRVx.js";import"./useLocale-drylJvgs.js";import"./Overflow-b40CqTdl.js";import"./PurePanel-C1JE1xpr.js";import"./useIcons-Bg9STVks.js";import"./CheckOutlined-C_iRVmUt.js";import"./DownOutlined-eQ1uAPVl.js";function ie(s){return U({attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M6 9.5C6.93191 9.5 7.71496 10.1374 7.93699 11H13.5C13.7761 11 14 11.2239 14 11.5C14 11.7455 13.8231 11.9496 13.5899 11.9919L13.5 12L7.93673 12.001C7.71435 12.8631 6.93155 13.5 6 13.5C5.06845 13.5 4.28565 12.8631 4.06327 12.001L2.5 12C2.22386 12 2 11.7761 2 11.5C2 11.2545 2.17688 11.0504 2.41012 11.0081L2.5 11H4.06301C4.28504 10.1374 5.06809 9.5 6 9.5ZM6 10.5C5.44772 10.5 5 10.9477 5 11.5C5 12.0523 5.44772 12.5 6 12.5C6.55228 12.5 7 12.0523 7 11.5C7 10.9477 6.55228 10.5 6 10.5ZM10 2.5C10.9319 2.5 11.715 3.13738 11.937 3.99998L13.5 4C13.7761 4 14 4.22386 14 4.5C14 4.74546 13.8231 4.94961 13.5899 4.99194L13.5 5L11.9367 5.00102C11.7144 5.86312 10.9316 6.5 10 6.5C9.06845 6.5 8.28565 5.86312 8.06327 5.00102L2.5 5C2.22386 5 2 4.77614 2 4.5C2 4.25454 2.17688 4.05039 2.41012 4.00806L2.5 4L8.06301 3.99998C8.28504 3.13738 9.06809 2.5 10 2.5ZM10 3.5C9.44772 3.5 9 3.94772 9 4.5C9 5.05228 9.44772 5.5 10 5.5C10.5523 5.5 11 5.05228 11 4.5C11 3.94772 10.5523 3.5 10 3.5Z"},child:[]}]})(s)}const de=({setIsAmenityOpen:s})=>{const[j]=le.useForm(),[d]=L(),c=d.get("keyword"),g=d.get("category");d.get("orderType"),d.get("filter");const u=S(),[r,i]=R(v),x=y.useCallback(async()=>{const o=r.amenityId.map(l=>`amenity_id=${l.amenity_id}`).join("&");try{const l=await k.get(`/api/search/filter?start_idx=0&category=숙소&search_word=${c}&${o}`);console.log("편의시설",l.data);const C=l.data;C.code==="200 성공"&&i(A=>({...A,searchData:C.data,more:C.data[0].more}))}catch(l){console.log("편의시설",l)}},[]);y.useEffect(()=>{console.log("선택된 필터",r.amenityId)},[r.amenityId]);const N=()=>{s(!1),i(o=>({...o,amenityId:[]}))},m=()=>{i(o=>({...o,amenityId:[]}))},b=o=>{i(l=>({...l,orderType:o}))},n=o=>{r.amenityId.includes(o)?i({...r,amenityId:r.amenityId.filter(l=>l!==o)}):i({...r,amenityId:[...r.amenityId,o]})},p=()=>{console.log("handleSubmit",r),i(o=>({...o,fromContent:!1})),s(!1),r.amenityId.length>0?(x(),u(`/search/strf?keyword=${c}&category=${g}&orderType=${r.orderType}&filter=selected`)):u(`/search/strf?keyword=${c}&category=${g}&orderType=${r.orderType}&filter=none`)};return e.jsx("div",{className:`fixed top-0 left-[50%] translate-x-[-50%] z-10\r
            max-w-[768px] w-full mx-auto h-screen\r
            bg-white`,children:e.jsxs("div",{className:"relative h-full",children:[e.jsx(J,{title:"필터",onClick:N}),e.jsxs("section",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"px-4 py-6",children:[e.jsx("h4",{className:"py-2 text-base font-semibold text-slate-700",children:"정렬"}),e.jsx("ul",{children:_.map((o,l)=>e.jsx("li",{className:"py-3 border-b border-slate-100",onClick:()=>b(l),children:e.jsx("button",{className:`text-sm  hover:text-primary transition-all duration-75
                      ${r.orderType===l?"text-primary":"text-slate-700"}`,children:o.name})},l))})]}),e.jsxs("div",{className:"px-4 py-6 flex flex-col gap-3",children:[e.jsx("h4",{className:"text-base font-semibold text-slate-700",children:"편의시설"}),e.jsx("ul",{className:"flex flex-wrap gap-[6px]",children:ae.map((o,l)=>{var C;return e.jsx("li",{onClick:()=>n(o),className:`w-fit px-3 py-[6px] rounded-lg border text-sm select-none cursor-pointer ${(C=r.amenityId)!=null&&C.includes(o)?"text-primary border-primary":"text-slate-500 border-slate-200"}`,children:o.key},l)})})]})]}),e.jsxs("section",{className:` absolute bottom-0 left-0 right-0 bg-white\r
      flex items-center gap-3 px-4 py-4 border-t border-slate-100`,children:[e.jsxs($,{className:"px-[14px] py-3 !h-auto text-base text-slate-500",onClick:m,children:[e.jsx(re,{className:"text-slate-300"}),"초기화"]}),e.jsx($,{type:"primary",className:"w-full px-[14px] py-3 !h-auto text-base",onClick:p,children:"적용하기"})]})]})})},T=({item:s,onClick:j})=>{var r,i,x;const d=S(),[c,g]=R(v),u=N=>{console.log("아이템 클릭"),g(m=>({...m,fromContent:!0})),d(`/contents/index?strfId=${N.strfId}`)};return e.jsxs("div",{className:"flex gap-[20px] items-center cursor-pointer",onClick:()=>u(s),children:[e.jsx("div",{className:"w-[130px] h-[130px] bg-slate-200 rounded-[8px] overflow-hidden select-none",children:e.jsx("img",{src:`${K}/${s.strfId}/${s.strfPic}`,alt:s.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col gap-[5px]",children:[e.jsx("div",{className:"flex gap-[5px] items-center ",children:e.jsx("h3",{className:"text-[20px] font-semibold text-slate-700 select-none",children:s.title||s.strfTitle})}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("p",{className:"text-[14px] text-slate-500",children:se(s.category)}),e.jsx("p",{className:"text-[14px] text-slate-500",children:"|"}),e.jsx("p",{className:"text-[14px] text-slate-500",children:s.locationName})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx(ce,{disabled:!0,count:1,value:s.hasMyReview!==0?1:0}),e.jsx("p",{className:"text-[12px] text-slate-500",children:s.averageRating?s.averageRating:"0"}),e.jsxs("p",{className:"text-[12px] text-slate-500",children:["(",s.reviewCount?(r=s.reviewCount)==null?void 0:r.toLocaleString():(i=s.reviewCnt)==null?void 0:i.toLocaleString(),")"]})]}),e.jsxs("div",{className:"flex gap-[5px] items-center",children:[e.jsx("div",{children:s.wishIn?e.jsx(Y,{className:"text-secondary3"}):e.jsx(q,{className:"text-slate-400"})}),e.jsx("p",{className:"text-[12px] text-slate-500",children:(x=s.wishlistCount)==null?void 0:x.toLocaleString()})]})]})]})},xe=()=>{const[s]=L(),j=s.get("keyword");s.get("category");const d=s.get("orderType"),c=S(),[g,u]=R(v);F(v);const r=B(v),i=r.searchData.filter(n=>n.category==="TOUR"),x=r.searchData.filter(n=>n.category==="STAY"),N=r.searchData.filter(n=>n.category==="RESTAUR"),m=r.searchData.filter(n=>n.category==="FEST"),b=n=>{u(p=>({...p,category:n,searchData:[]})),c(`/search/strf?keyword=${j}&category=${n}&orderType=${d}`),Q()};return e.jsxs(e.Fragment,{children:[r.searchData.length===0&&e.jsx(E,{content:"검색 결과가 없습니다."}),r.searchData.length>0&&e.jsxs(e.Fragment,{children:[i.length>0&&e.jsx(e.Fragment,{children:e.jsxs("section",{className:"flex flex-col gap-5 items-center mb-10",children:[e.jsx("h2",{className:"w-full text-lg font-semibold text-slate-700",children:"관광지"}),e.jsx("ul",{className:"w-full flex flex-col gap-5",children:i.map((n,p)=>e.jsx(T,{item:n},p))}),e.jsx($,{className:`px-5 py-4 border border-slate-300 \r
        rounded-3xl text-base text-slate-600`,onClick:()=>b(1),children:"더보기"})]})}),x.length>0&&e.jsx(e.Fragment,{children:e.jsxs("section",{className:"flex flex-col gap-5 items-center mb-10",children:[e.jsx("h2",{className:"w-full text-lg font-semibold text-slate-700",children:"숙소"}),e.jsx("ul",{className:"w-full flex flex-col gap-5",children:x.map((n,p)=>e.jsx(T,{item:n},p))}),e.jsx($,{className:`px-5 py-4 border border-slate-300 \r
        rounded-3xl text-base text-slate-600`,onClick:()=>b(2),children:"더보기"})]})}),N.length>0&&e.jsx(e.Fragment,{children:e.jsxs("section",{className:"flex flex-col gap-5 items-center mb-10",children:[e.jsx("h2",{className:"w-full text-lg font-semibold text-slate-700",children:"맛집"}),e.jsx("ul",{className:"w-full flex flex-col gap-5",children:N.map((n,p)=>e.jsx(T,{item:n},p))}),e.jsx($,{className:`px-5 py-4 border border-slate-300 \r
        rounded-3xl text-base text-slate-600`,onClick:()=>b(3),children:"더보기"})]})}),m.length>0&&e.jsx(e.Fragment,{children:e.jsxs("section",{className:"flex flex-col gap-5 items-center mb-10",children:[e.jsx("h2",{className:"w-full text-lg font-semibold text-slate-700",children:"축제"}),e.jsx("ul",{className:"w-full flex flex-col gap-5",children:m.map((n,p)=>e.jsx(T,{item:n},p))}),e.jsx($,{className:`px-5 py-4 border border-slate-300 \r
        rounded-3xl text-base text-slate-600`,onClick:()=>b(4),children:"더보기"})]})})]})]})},Ve=()=>{const s=W("accessToken"),[j]=L(),d=j.get("keyword"),c=Number(j.get("category")),g=Number(j.get("orderType")),u=j.get("filter"),r=S(),[i,x]=R(v),N=F(v),m=B(v);console.log("searchValue",m);const b=y.useRef(null);y.useRef(null);const[n,p]=y.useState(!1),[o,l]=y.useState(!1),C=y.useCallback(()=>{},[]),A=y.useCallback(async t=>{const a=`/api/search/all?search_word=${t}`;if(l(!0),s)try{const f=(await k.get(a,{headers:{Authorization:`Bearer ${s}`}})).data;f&&l(!1),x(w=>({...w,searchData:f.data,start_idx:0,category:0,amenityId:[],orderType:0}))}catch(h){console.log("전체 검색",h),l(!1)}else try{const f=(await k.get(a)).data;f&&l(!1),x(w=>({...w,searchData:f.data}))}catch(h){console.log("전체 검색",h),l(!1)}},[]),M=async()=>{const t="/api/search/category";if(l(!0),s)try{const h=(await k.get(`${t}?start_idx=${i.start_idx}&category=${I[c].name}&search_word=${d}&order_type=${_[g].type}`,{headers:{Authorization:`Bearer ${s}`}})).data,f=h.data.dtoList,w=h.data.more;console.log(w),console.log(h),h.code==="200 성공"&&(l(!1),x(D=>({...D,searchData:[...D.searchData,...f],more:w})))}catch(a){console.log("카테고리 검색",a)}else try{const h=(await k.get(`${t}?start_idx=${i.start_idx}&category=${I[c].name}&search_word=${d}&order_type=${_[g].type}`)).data,f=h.data.dtoList,w=h.data.more;console.log(f),h.code==="200 성공"&&(l(!1),x(D=>({...D,searchData:[...D.searchData,...f],more:w})))}catch(a){console.log("카테고리 검색",a)}},P=y.useCallback(async()=>{const t=i.amenityId.map(a=>`amenity_id=${a.amenity_id}`).join("&");try{const a=await k.get(`/api/search/filter?start_idx=${i.start_idx}&category=숙소&search_word=${d}&${t}`);console.log("편의시설",a.data);const h=a.data;h.code==="200 성공"&&x(f=>({...f,searchData:[...f.searchData,...h.data],more:h.data[0].more}))}catch(a){console.log("편의시설",a)}},[]),H=async()=>{try{const t=await k.get(`/api/search/count?category=${I[c].name}&search_word=${d}`);console.log("검색 총 수",t.data),x(a=>({...a,count:t.data.data}))}catch(t){console.log("검색 총 수",t)}},O=t=>{N(),t.target.value.trim()&&(x(a=>({...a,fromContent:!1})),r(`/search/strf?keyword=${t.target.value}&category=0&orderType=0&filter=none`))},V=t=>{r(`/search/strf?keyword=${d}&category=${t}&orderType=${g}&filter=none`),t!==c&&x(a=>({...a,start_idx:0,searchData:[],category:t,fromContent:!1}))},Z=t=>{r(`/search/strf?keyword=${d}&category=${c}&orderType=${t}&filter=none`),x(a=>({...a,orderType:t,start_idx:0,fromContent:!1,searchData:[]}))},z=()=>{x(t=>({...t,start_idx:t.start_idx+10}))},G=()=>{p(!0)};return y.useEffect(()=>{c===0?A(d):m.fromContent===!1&&(M(),H())},[d,c,g,m.start_idx]),e.jsxs("div",{className:"w-full flex flex-col mb-[100px]",children:[e.jsxs("section",{className:"w-full px-4 py-4 flex items-center gap-3 relative",ref:b,children:[e.jsx("div",{className:"text-3xl cursor-pointer",onClick:()=>{r(c===0?"/search/before":`/search/strf?keyword=${d}&category=0&orderType=${g}`)},children:e.jsx(X,{})}),e.jsx("label",{htmlFor:"searchBar",className:"relative w-full",children:e.jsx(ee,{id:"searchBar",placeholder:"관광지, 장소, 숙소,맛집을 검색해 보세요",allowClear:!0,onClear:C,suffix:e.jsx(te,{className:"text-slate-400 text-2xl"}),defaultValue:d,onPressEnter:t=>O(t),variant:"filled",className:`max-h-[60px] h-[16vw] text-base rounded-lg gap-[5px]\r
            bg-slate-50 hover:bg-slate-100 placeholder:text-slate-400 `})})]}),e.jsxs("section",{className:"pb-8 flex flex-col",children:[e.jsx("ul",{className:"py-4 flex gap-3 px-4 ",children:I.map((t,a)=>e.jsx("li",{className:`cursor-pointer text-sm w-full flex justify-center items-center py-2 gap-[10px] rounded-xl ${a===c?"bg-primary text-white":"bg-white text-slate-500"}`,onClick:()=>{V(a)},children:e.jsxs("p",{className:"text-center",children:[" ",t.name]})},a))}),e.jsx("div",{className:"h-[2.66vw] max-h-[10px] bg-slate-100"}),c!==0&&e.jsxs("div",{className:"flex items-center gap-3 justify-between px-4 py-4",children:[e.jsx("div",{className:"text-sm text-slate-700 font-semibold",children:c===0?null:`총 ${m.count}개`}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs($,{onClick:G,type:"button",className:`text-xs
                    ${c===2?"visible":"invisible"}
                    ${u==="selected"?"text-primary":"text-slate-500"}`,children:["필터 ",e.jsx(ie,{}),i.amenityId.length>0?e.jsxs("span",{children:["선택 ",i.amenityId.length,"개"]}):e.jsxs("span",{children:["선택 ",i.amenityId.length,"개"]})]}),c!==0&&e.jsx(oe,{value:m.orderType,onChange:Z,options:_.map((t,a)=>({value:a,label:e.jsx("span",{className:"text-slate-500 text-xs",children:t.name})})),style:{color:"#64748b"},className:"h-[4.53vw] max-h-[17px]",variant:"borderless"})]})]})]}),e.jsxs("section",{className:"px-8 pb-8 flex flex-col min-h-screen",children:[e.jsxs(ne,{spinning:o,children:[m.searchData.length===0&&o===!0&&e.jsx("div",{className:"flex flex-col items-center p-20"}),m.searchData.length===0&&o===!1&&e.jsx(E,{content:"검색 결과가 없습니다."}),m.searchData.length>0&&c===0&&e.jsx(xe,{}),m.searchData.length>0&&c!==0&&e.jsx("ul",{className:"flex flex-col gap-[20px]",children:m.searchData.map((t,a)=>e.jsx(T,{item:t},a))})]}),c!==0&&m.more&&e.jsx("div",{className:"flex justify-center items-center py-4",children:e.jsx($,{className:`px-5 py-4 border border-slate-300 \r
        rounded-3xl text-base text-slate-600`,onClick:()=>{u==="none"?z():P()},children:"더보기"})})]}),n&&e.jsx(de,{setIsAmenityOpen:p})]})};export{Ve as default};
