import{g as d,r as o,j as c,l as s}from"./index-CclgMCKg.js";const x=({token:a})=>{const u=d("accessToken"),[i,r]=o.useState(!1),l=s.EventSourcePolyfill||s.NativeEventSource,t=o.useRef(null);return o.useEffect(()=>{if(!u)return;const n=()=>{t.current=new l("/api/notice",{headers:{Authorization:`Bearer ${a}`,Connetction:"keep-alive",Accept:"text/event-stream","Cache-Control":"no-cache"},withCredentials:!0}),t.current.onmessage=e=>{console.log("새로운 알림:",e.data)},t.current.addEventListener("first_check_unread_notice",e=>{console.log("초기 알림 확인:",e.data),e.data==="true"&&r(!0)}),t.current.addEventListener("exist unread notice",e=>{console.log("안 읽은 알림 존재:",e.data),r(!0)}),t.current.onerror=async()=>{var e;(e=t.current)==null||e.close(),setTimeout(n,36e5)},t.current.onopen=()=>{}};return n(),()=>{var e;(e=t.current)==null||e.close()}},[t]),c.jsx("div",{children:i&&c.jsx("span",{className:"absolute top-[1px] right-[1px] w-[6px] h-[6px] bg-secondary3 border-2 border-white box-content rounded-full"})})};export{x as N};
